(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96394,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(71645);let a="http://192.168.1.34:3221/DailyUpdate";function l(){let[e,l]=(0,s.useState)([]),[r,d]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[o,n]=(0,s.useState)({syllabusTypeId:"",classSyllabusId:"",subjectId:"",chapterNumber:"",chapterName:""}),[m,p]=(0,s.useState)(""),[u,h]=(0,s.useState)([]),[b,x]=(0,s.useState)("new"),[g,y]=(0,s.useState)(null),[f,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)(!0),[v,S]=(0,s.useState)({type:"",text:""});(0,s.useEffect)(()=>{(async()=>{try{let[e,t,s]=await Promise.all([fetch("".concat(a,"/syllabustypes")),fetch("".concat(a,"/classes")),fetch("".concat(a,"/subjects"))]);l(await e.json()),d(await t.json()),c(await s.json())}catch(e){S({type:"error",text:"Failed to load initial data. Check API connection."})}finally{w(!1)}})()},[]);let C=(0,s.useCallback)(async()=>{let{syllabusTypeId:e,classSyllabusId:t,subjectId:s}=o;if(!e||!t||!s)return void h([]);j(!0);try{let l="".concat(a,"/chapters-by-filter?syllabusTypeId=").concat(e,"&classSyllabusId=").concat(t,"&subjectId=").concat(s),r=await fetch(l);if(!r.ok)throw Error("Could not fetch chapters.");let d=await r.json();h(d)}catch(e){S({type:"error",text:e.message})}finally{j(!1)}},[o]);(0,s.useEffect)(()=>{C()},[o.syllabusTypeId,o.classSyllabusId,o.subjectId,C]);let T=e=>{let{name:t,value:s}=e.target;n(e=>({...e,[t]:s}))},I=async e=>{e.preventDefault(),S({type:"",text:""});let t=m.split("\n").filter(e=>""!==e.trim());if(0===t.length)return void S({type:"error",text:"Please enter at least one topic."});try{let e;if("new"===b){let s=JSON.stringify({...o,topics:t});e=await fetch("".concat(a,"/add-chapter-with-topics"),{method:"POST",headers:{"Content-Type":"application/json"},body:s})}else{let s=JSON.stringify({chapterId:g.id,topics:t});e=await fetch("".concat(a,"/add-topics-to-chapter"),{method:"POST",headers:{"Content-Type":"application/json"},body:s})}let s=await e.json();if(!e.ok)throw Error(s.message);S({type:"success",text:s.message}),p(""),"new"===b&&n(e=>({...e,chapterNumber:"",chapterName:""})),C()}catch(e){S({type:"error",text:e.message})}};return N?(0,t.jsx)("div",{className:"text-center p-10",children:"Loading form data..."}):(0,t.jsx)("main",{className:"bg-slate-50 min-h-screen p-4 sm:p-8",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"new"===b?"Add New Chapter":"Add Topics to Chapter"}),"addTopics"===b&&(0,t.jsx)("button",{onClick:()=>{x("new"),y(null),n(e=>({...e,chapterNumber:"",chapterName:""})),p(""),S({type:"",text:""})},className:"text-sm bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-lg hover:bg-gray-300",children:"+ Add New Chapter Instead"})]}),(0,t.jsxs)("form",{onSubmit:I,className:"space-y-5",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"syllabusTypeId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Syllabus"}),(0,t.jsxs)("select",{name:"syllabusTypeId",value:o.syllabusTypeId,onChange:T,required:!0,disabled:"addTopics"===b,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select Syllabus"}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.syllabus_name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"classSyllabusId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),(0,t.jsxs)("select",{name:"classSyllabusId",value:o.classSyllabusId,onChange:T,required:!0,disabled:"addTopics"===b,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select Class"}),r.map(e=>(0,t.jsx)("option",{value:e.id,children:e.class_name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"subjectId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,t.jsxs)("select",{name:"subjectId",value:o.subjectId,onChange:T,required:!0,disabled:"addTopics"===b,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select Subject"}),i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.subject_name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsx)("label",{htmlFor:"chapterNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Chapter No."}),(0,t.jsx)("input",{type:"number",name:"chapterNumber",value:o.chapterNumber,onChange:T,placeholder:"e.g., 10",required:!0,disabled:"addTopics"===b,className:"w-full px-3 py-2 border border-gray-300 rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"chapterName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Chapter Name"}),(0,t.jsx)("input",{type:"text",name:"chapterName",value:o.chapterName,onChange:T,placeholder:"e.g., Light - Reflection",required:!0,disabled:"addTopics"===b,className:"w-full px-3 py-2 border border-gray-300 rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"topics",className:"block text-sm font-medium text-gray-700 mb-1",children:"Topics (one per line)"}),(0,t.jsx)("textarea",{name:"topics",rows:"4",value:m,onChange:e=>p(e.target.value),placeholder:"Topic 1 Topic 2",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:"new"===b?"Add Chapter & Topics":"Add More Topics"})]}),v.text&&(0,t.jsx)("div",{className:"p-4 mt-4 rounded-md text-center font-medium ".concat("success"===v.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:v.text})]}),o.subjectId&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Existing Chapters"}),f?(0,t.jsx)("p",{children:"Loading chapters..."}):u.length>0?(0,t.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,t.jsxs)("details",{className:"group bg-white rounded-lg border border-gray-200",children:[(0,t.jsxs)("summary",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50",children:[(0,t.jsxs)("span",{className:"font-medium text-gray-700",children:["Ch. ",e.Chapter_Number,": ",e.Chapter_Name]}),(0,t.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),x("addTopics"),y(e),n(t=>({...t,chapterNumber:e.Chapter_Number,chapterName:e.Chapter_Name})),p(""),S({type:"",text:""}),window.scrollTo({top:0,behavior:"smooth"})},className:"text-xs bg-indigo-100 text-indigo-700 font-semibold py-1 px-3 rounded-full hover:bg-indigo-200 z-10 transition-colors",children:"Add Topics"})]}),(0,t.jsx)("div",{className:"px-4 pb-3 border-t",children:e.topics.length>0?(0,t.jsx)("ul",{className:"list-disc list-inside mt-2 space-y-1 text-gray-600",children:e.topics.map((e,s)=>(0,t.jsx)("li",{children:e},s))}):(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No topics for this chapter."})})]},e.id))}):(0,t.jsx)("p",{className:"text-gray-500",children:"No chapters found for this selection. Add one using the form above!"})]})]})})}}]);