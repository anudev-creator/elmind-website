{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/src/app/verify_otp/page.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","\"use client\";\r\nimport { useState, useEffect, useRef } from 'react';\r\n\r\n// Standard Components\r\nconst MenuBar = () => (\r\n    <nav className=\"w-full p-4 bg-white shadow-sm flex justify-between items-center\">\r\n        <div className=\"font-bold text-xl\">Elmind.</div>\r\n    </nav>\r\n);\r\n\r\nconst Footer = () => (\r\n    <footer className=\"w-full p-6 bg-gray-100 text-center text-gray-500 text-sm mt-auto\">\r\n        &copy; 2025 Elmind Inc.\r\n    </footer>\r\n);\r\n\r\nexport default function VerifyOTP() {\r\n    const [otp, setOtp] = useState(['', '', '', '', '', '']);\r\n    const [phone, setPhone] = useState(null);\r\n    const [timer, setTimer] = useState(60);\r\n    const [error, setError] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    \r\n    // Use useRef for values that shouldn't trigger re-renders but need to persist\r\n    const hasRan = useRef(false);\r\n\r\n    // 1. Phone Number Logic\r\n    useEffect(() => {\r\n        if (hasRan.current) return;\r\n        hasRan.current = true;\r\n\r\n        const storedPhone = localStorage.getItem('phoneNumber');\r\n        const CheckToken = localStorage.getItem('CheckToken');\r\n\r\n        console.log(`Phone number: ${storedPhone} \\nToken:${CheckToken}`);\r\n        \r\n        \r\n        if (storedPhone && CheckToken) {\r\n            setPhone(storedPhone);\r\n            // Optional: Keep it until success, or remove immediately depending on preference\r\n            localStorage.removeItem('CheckToken'); \r\n            console.log(localStorage.getItem('CheckToken'));\r\n            return;\r\n        }\r\n        localStorage.removeItem('CheckToken'); \r\n        // If no phone found, redirect\r\n        window.location.replace('/');\r\n    }, []);\r\n\r\n    // 2. Timer Logic (The missing piece)\r\n    useEffect(() => {\r\n        // Only set interval if timer is > 0\r\n        let interval;\r\n        if (timer > 0) {\r\n            interval = setInterval(() => {\r\n                setTimer((prev) => (prev > 0 ? prev - 1 : 0));\r\n            }, 1000);\r\n        }\r\n\r\n        // Cleanup interval on unmount or when timer changes\r\n        return () => clearInterval(interval);\r\n    }, [timer]);\r\n\r\n    const handleChange = (element, index) => {\r\n        if (isNaN(element.value)) return;\r\n        const newOtp = [...otp];\r\n        newOtp[index] = element.value;\r\n        setOtp(newOtp);\r\n        if (element.nextSibling && element.value) {\r\n            element.nextSibling.focus();\r\n        }\r\n    };\r\n\r\n    const handleVerify = async (e) => {\r\n        e.preventDefault();\r\n        const enteredCode = otp.join('');\r\n\r\n        if (enteredCode.length < 6) {\r\n            setError('Please enter the full 6-digit code.');\r\n            return;\r\n        }\r\n\r\n        setIsLoading(true);\r\n        setError('');\r\n\r\n        try {\r\n            const baseUrl = process.env.NEXT_PUBLIC_PUBLIC_URL;\r\n\r\n            const response = await fetch(`${baseUrl}/AccountManagingSystem/api/verify-otp`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    phone: phone,\r\n                    otp: enteredCode\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (data.success) {\r\n                const secureToken = data.token;\r\n\r\n                sessionStorage.setItem('elmind_access_token', secureToken);\r\n                sessionStorage.setItem('elmind_user_phone', phone);\r\n                sessionStorage.removeItem('elmind_page_visited');\r\n                localStorage.removeItem('phoneNumber');\r\n                window.location.href = '/reset-password/secure';\r\n\r\n            } else {\r\n                setError(data.message || 'Invalid Code');\r\n            }\r\n\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col min-h-screen bg-gray-50\">\r\n            <MenuBar />\r\n            <main className=\"flex-grow flex flex-col justify-center items-center p-4\">\r\n                <div className=\"w-full max-w-md bg-white rounded-2xl shadow-[5px_4px_0px_0px_#000000] border-2 border-black p-8\">\r\n                    <div className=\"text-center mb-8\">\r\n                        <h2 className=\"text-2xl font-bold text-gray-800\">Verify It's You</h2>\r\n                        <p className=\"text-gray-600 mt-2 text-sm\">\r\n                            Enter code sent to <span className=\"font-bold text-black\">{phone || \"...\"}</span>\r\n                        </p>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleVerify} className=\"space-y-6\">\r\n                        <div className=\"flex justify-center gap-2\">\r\n                            {otp.map((data, index) => (\r\n                                <input\r\n                                    key={index}\r\n                                    type=\"text\"\r\n                                    maxLength=\"1\"\r\n                                    value={data}\r\n                                    onChange={e => handleChange(e.target, index)}\r\n                                    onFocus={e => e.target.select()}\r\n                                    className=\"w-12 h-12 text-center text-xl font-bold border-2 border-gray-300 rounded-lg focus:border-[#2AA5A3] focus:ring-2 focus:ring-[#2AA5A3]/50 outline-none transition-all\"\r\n                                />\r\n                            ))}\r\n                        </div>\r\n\r\n                        {error && <p className=\"text-red-500 text-center text-sm font-bold bg-red-50 p-2 rounded\">{error}</p>}\r\n\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={isLoading}\r\n                            className=\"w-full bg-[#2AA5A3] shadow-[5px_4px_0px_0px_#000000] p-3 rounded-xl text-white font-semibold hover:-translate-y-1 active:translate-y-0 active:shadow-[2px_2px_0px_0px_#000000] transition-all\"\r\n                        >\r\n                            {isLoading ? 'Verifying...' : 'Verify Code'}\r\n                        </button>\r\n                    </form>\r\n\r\n                    <div className=\"text-center mt-6 text-sm text-gray-600\">\r\n                        {timer > 0 ? (\r\n                            <p>Resend code in <span className=\"font-bold text-[#2AA5A3]\">{timer}s</span></p>\r\n                        ) : (\r\n                            <button \r\n                                onClick={() => {\r\n                                    setTimer(60);\r\n                                    // Add resend API call logic here if needed\r\n                                    alert(\"Code resent!\");\r\n                                }} \r\n                                className=\"text-[#2AA5A3] font-bold hover:underline\"\r\n                            >\r\n                                Resend Code\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                    \r\n                    <div className=\"mt-4 text-center\">\r\n                        <p className=\"text-xs text-gray-400\">(Preview Tip: Use code 123456)</p>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n            <Footer />\r\n        </div>\r\n    );\r\n}"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2]}